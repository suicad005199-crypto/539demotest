<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CSV 號碼分析器</title>
<style>
  body {
    font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", Helvetica, Arial, sans-serif;
    padding: 20px;
    background-color: #f9f9f9;
  }
  h1 {
    text-align: center;
    font-size: 24px;
  }
  input[type="file"] {
    display: block;
    margin: 20px auto;
    font-size: 18px;
  }
  button {
    display: block;
    margin: 20px auto;
    padding: 15px 30px;
    font-size: 18px;
    border: none;
    background-color: #007AFF;
    color: white;
    border-radius: 12px;
  }
  #result {
    margin-top: 20px;
    text-align: center;
    font-size: 20px;
    word-break: break-word;
  }
</style>
</head>
<body>

<h1>CSV 號碼分析器</h1>
<input type="file" id="csvFile" accept=".csv">
<button id="analyzeBtn">分析 CSV</button>
<div id="result"></div>

<script>
document.getElementById('analyzeBtn').addEventListener('click', () => {
  const fileInput = document.getElementById('csvFile');
  const file = fileInput.files[0];
  const resultDiv = document.getElementById('result');

  if (!file) {
    alert('請先選擇 CSV 檔案');
    return;
  }

  const reader = new FileReader();
  reader.onload = function(e) {
    const text = e.target.result;
    const rows = text.trim().split(/\r?\n/);
    let numbers = [];

    // 將 CSV 內容拆成數字
    rows.forEach(row => {
      const cols = row.split(/,|;/); // 支援逗號或分號分隔
      cols.forEach(col => {
        const num = parseInt(col.trim());
        if (!isNaN(num)) {
          numbers.push(num);
        }
      });
    });

    // 計算每個號碼出現次數
    const freqMap = {};
    numbers.forEach(n => {
      freqMap[n] = (freqMap[n] || 0) + 1;
    });

    // 找出出現頻率最高的前 5 個號碼
    const topNumbers = Object.keys(freqMap)
      .map(k => ({num: parseInt(k), count: freqMap[k]}))
      .sort((a,b) => b.count - a.count)
      .slice(0,5)
      .map(o => o.num);

    resultDiv.innerHTML = '前五高頻率號碼：<strong>' + topNumbers.join(', ') + '</strong>';
  };

  reader.readAsText(file);
});
</script>

</body>
</html>
