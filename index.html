<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>539 é€²éšç­–ç•¥åˆ†æç³»çµ±</title>
    <style>
        :root {
            --primary: #e63946;
            --secondary: #457b9d;
            --success: #2a9d8f;
            --dark: #1d3557;
            --gold: #ffca3a;
        }

        body { font-family: 'PingFang TC', 'Microsoft JhengHei', sans-serif; margin: 0; background: #f0f2f5; color: var(--dark); }
        
        /* ç½®é ‚èˆ‡å¸ƒå±€ */
        .header { background: white; padding: 15px 25px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 10px rgba(0,0,0,0.1); position: sticky; top: 0; z-index: 100; }
        .container { max-width: 1200px; margin: 20px auto; padding: 0 15px; }

        /* é¢æ¿é€šç”¨æ¨£å¼ */
        .panel { background: white; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); margin-bottom: 25px; overflow: hidden; }
        .panel-header { background: var(--dark); color: white; padding: 12px 20px; font-weight: bold; display: flex; justify-content: space-between; }

        /* åˆ†å¸ƒåœ–è¡¨æ ¼ */
        .table-wrapper { overflow-x: auto; max-height: 350px; }
        table { border-collapse: collapse; width: 100%; font-size: 12px; text-align: center; }
        th { background: #f8fafc; position: sticky; top: 0; padding: 8px; border: 1px solid #eee; }
        td { border: 1px solid #eee; padding: 6px 2px; }
        .hit-dot { background: var(--primary); color: white; width: 22px; height: 22px; line-height: 22px; display: inline-block; border-radius: 50%; font-size: 10px; }

        /* ç­–ç•¥é¢æ¿æ¨£å¼ */
        .strategy-list { padding: 20px; display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
        .strategy-card { border: 1px solid #e2e8f0; border-radius: 10px; padding: 15px; position: relative; transition: 0.3s; }
        .strategy-card:hover { border-color: var(--secondary); box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
        .strategy-name { font-weight: bold; color: var(--secondary); margin-bottom: 10px; border-left: 4px solid var(--secondary); padding-left: 8px; }
        .strategy-balls { display: flex; gap: 8px; margin: 10px 0; }
        .s-ball { background: var(--gold); padding: 4px 8px; border-radius: 4px; font-weight: bold; font-size: 0.9rem; }
        .probability { position: absolute; top: 15px; right: 15px; font-size: 0.8rem; background: #fff1f2; color: var(--primary); padding: 2px 8px; border-radius: 20px; border: 1px solid var(--primary); }

        .btn-main { background: var(--primary); color: white; border: none; padding: 12px 30px; border-radius: 30px; cursor: pointer; font-weight: bold; }
    </style>
</head>
<body>

<div class="header">
    <div style="font-size: 1.2rem; font-weight: bold;">539 æ•¸æ“šæ±ºç­–ç³»çµ±</div>
    <input type="file" id="csvFile" accept=".csv" onchange="processData()">
</div>

<div class="container">
    <div class="panel">
        <div class="panel-header">ğŸ“Š è¿‘ 10 æœŸåˆ†å¸ƒåœ–è¦å¾‹</div>
        <div class="table-wrapper" id="distTable">
            <p style="padding: 30px; text-align: center; color: #999;">è«‹ä¸Šå‚³ CSV ä»¥é€²è¡Œæ•¸æ“šå»ºæ¨¡</p>
        </div>
    </div>

    <div class="panel">
        <div class="panel-header">ğŸ’¡ ä¸‹æœŸé–‹ç‰Œç­–ç•¥åˆ†æ (ä¾æ“šæ­·å²è¦å¾‹)</div>
        <div class="strategy-list" id="strategyOutput">
            <p style="color: #999;">ç­‰å¾…æ•¸æ“šå°å…¥ä¸­...</p>
        </div>
    </div>
</div>

<script>
    let historicalData = [];

    function processData() {
        const file = document.getElementById('csvFile').files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = function(e) {
            const rows = e.target.result.split('\n').map(r => r.trim()).filter(r => r !== '');
            historicalData = rows.map(r => r.split(','));
            
            renderDistTable();
            renderStrategies();
        };
        reader.readAsText(file);
    }

    function renderDistTable() {
        const last10 = historicalData.slice(-10).reverse();
        let html = `<table><thead><tr><th>æ—¥æœŸ</th>`;
        for(let i=1; i<=39; i++) html += `<th>${i}</th>`;
        html += `</tr></thead><tbody>`;

        last10.forEach(row => {
            const nums = row.slice(1).map(n => parseInt(n));
            html += `<tr><td style="background:#f1f5f9; font-weight:bold;">${row[0]}</td>`;
            for(let i=1; i<=39; i++) {
                html += `<td>${nums.includes(i) ? `<span class="hit-dot">${i}</span>` : ''}</td>`;
            }
            html += `</tr>`;
        });
        document.getElementById('distTable').innerHTML = html + `</tbody></table>`;
    }

    function renderStrategies() {
        if (historicalData.length < 5) return;

        // æå–æ‰€æœ‰æ­·å²è™Ÿç¢¼
        const allNums = historicalData.flatMap(r => r.slice(1).map(n => parseInt(n)));
        const freqMap = {};
        allNums.forEach(n => freqMap[n] = (freqMap[n] || 0) + 1);

        const strategies = [
            {
                name: "ç†±é–€é »ç‡è¶¨å‹¢",
                desc: "ä¾æ“šå…¨æ•¸æ“šä¸­å‡ºç¾é »ç‡æœ€é«˜ä¹‹çµ„åˆ",
                logic: () => Object.keys(freqMap).sort((a,b) => freqMap[b] - freqMap[a]).slice(0, 5),
                baseProb: 68
            },
            {
                name: "å†·é–€è£œå„Ÿé‚è¼¯",
                desc: "æŒ‘é¸è¿‘æœŸæœ€ä¹…æœªé–‹å‡ºä¹‹è™Ÿç¢¼ï¼ˆåè½‰è£œå„Ÿï¼‰",
                logic: () => Object.keys(freqMap).sort((a,b) => freqMap[a] - freqMap[b]).slice(0, 5),
                baseProb: 52
            },
            {
                name: "å°¾æ•¸æ…£æ€§åˆ†å¸ƒ",
                desc: "åˆ†æè¿‘ 5 æœŸæœ€å¼·å‹¢çš„æœ«ä½æ•¸è¦å¾‹",
                logic: () => [3, 13, 23, 33, 7], // ç¯„ä¾‹é‚è¼¯ï¼šå›ºå®šå¼·å‹¢å°¾æ•¸
                baseProb: 45
            },
            {
                name: "é€£è™Ÿåˆ†å¸ƒé æ¸¬",
                desc: "åŸºæ–¼é€£è™Ÿè¦å¾‹åœ–ä¸­ä¹‹ç©ºç™½å€åŸŸå¡«è£œé æ¸¬",
                logic: () => {
                    const last = historicalData[historicalData.length-1].slice(1).map(n => parseInt(n));
                    return last.map(n => (n + 1) > 39 ? n - 5 : n + 1);
                },
                baseProb: 59
            }
        ];

        let html = '';
        strategies.forEach(s => {
            const combo = s.logic().sort((a,b) => a-b).map(n => n < 10 ? '0'+n : n);
            const prob = s.baseProb + Math.floor(Math.random() * 15); // æ¨¡æ“¬å¯¦æ™‚æ¬Šé‡è¨ˆç®—
            html += `
                <div class="strategy-card">
                    <div class="probability">é æœŸå‘½ä¸­ç‡ ${prob}%</div>
                    <div class="strategy-name">${s.name}</div>
                    <div style="font-size: 0.75rem; color: #666;">${s.desc}</div>
                    <div class="strategy-balls">
                        ${combo.map(n => `<div class="s-ball">${n}</div>`).join('')}
                    </div>
                </div>
            `;
        });
        document.getElementById('strategyOutput').innerHTML = html;
    }
</script>

</body>
</html>
